<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encoder-Decoder vs Autoencoder vs VAE æ¶æ§‹æ¯”è¼ƒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.2em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .architecture-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .architecture-section h2 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        canvas {
            width: 100%;
            height: 250px;
            border-radius: 10px;
            background: white;
            display: block;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .description {
            background: white;
            padding: 15px;
            border-radius: 10px;
            line-height: 1.8;
        }
        
        .description ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        .description li {
            margin-bottom: 8px;
        }
        
        .key-point {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 12px 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-weight: 600;
            color: #1565c0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        
        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: white;
            padding: 8px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .legend-box {
            width: 30px;
            height: 20px;
            border-radius: 3px;
            border: 2px solid #333;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.5em;
            }
            
            canvas {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ï¸ ä¸‰ç¨®æ¶æ§‹æµç¨‹æ¯”è¼ƒåœ–</h1>
        <p class="subtitle">Encoder-Decoderã€Autoencoderã€VAE çš„æ¶æ§‹èˆ‡è³‡æ–™æµå‹•æ–¹å¼</p>
        
        <!-- Encoder-Decoder -->
        <div class="architecture-section">
            <h2>
                <span style="font-size: 1.5em;">ğŸ”„</span>
                Encoder-Decoderï¼ˆåºåˆ—åˆ°åºåˆ—ï¼‰
            </h2>
            <canvas id="encoderDecoderCanvas"></canvas>
            <div class="description">
                <strong>æµç¨‹èªªæ˜ï¼š</strong>
                <ul>
                    <li><strong>è¼¸å…¥ï¼š</strong>æºåºåˆ—ï¼ˆä¾‹å¦‚ï¼šè‹±æ–‡å¥å­ï¼‰</li>
                    <li><strong>Encoderï¼š</strong>å°‡æºåºåˆ—å£“ç¸®æˆå›ºå®šé•·åº¦çš„ä¸Šä¸‹æ–‡å‘é‡ (context vector)</li>
                    <li><strong>Decoderï¼š</strong>æ ¹æ“šä¸Šä¸‹æ–‡å‘é‡ç”Ÿæˆç›®æ¨™åºåˆ—ï¼ˆä¾‹å¦‚ï¼šä¸­æ–‡ç¿»è­¯ï¼‰</li>
                    <li><strong>è¼¸å‡ºï¼š</strong>ç›®æ¨™åºåˆ—ï¼ˆèˆ‡è¼¸å…¥<strong>ä¸åŒ</strong>ï¼‰</li>
                </ul>
                <div class="key-point">
                    ğŸ¯ é—œéµç‰¹é»ï¼šè¼¸å…¥å’Œè¼¸å‡ºæ˜¯<strong>ä¸åŒçš„è³‡æ–™</strong>ï¼Œç”¨æ–¼åºåˆ—è½‰æ›ä»»å‹™
                </div>
            </div>
        </div>
        
        <!-- Autoencoder -->
        <div class="architecture-section">
            <h2>
                <span style="font-size: 1.5em;">ğŸ”µ</span>
                Autoencoderï¼ˆè‡ªç·¨ç¢¼å™¨ï¼‰
            </h2>
            <canvas id="autoencoderCanvas"></canvas>
            <div class="description">
                <strong>æµç¨‹èªªæ˜ï¼š</strong>
                <ul>
                    <li><strong>è¼¸å…¥ï¼š</strong>åŸå§‹è³‡æ–™ Xï¼ˆä¾‹å¦‚ï¼šä¸€å¼µåœ–ç‰‡ï¼‰</li>
                    <li><strong>Encoderï¼š</strong>å°‡è³‡æ–™å£“ç¸®æˆä½ç¶­åº¦çš„<strong>ç¢ºå®šæ€§æ½›åœ¨å‘é‡ z</strong></li>
                    <li><strong>Decoderï¼š</strong>å¾æ½›åœ¨å‘é‡ z é‡å»ºåŸå§‹è³‡æ–™</li>
                    <li><strong>è¼¸å‡ºï¼š</strong>é‡å»ºçš„è³‡æ–™ X'ï¼ˆç›¡å¯èƒ½æ¥è¿‘è¼¸å…¥ Xï¼‰</li>
                </ul>
                <div class="key-point">
                    ğŸ¯ é—œéµç‰¹é»ï¼šè¼¸å…¥å’Œè¼¸å‡ºæ˜¯<strong>ç›¸åŒçš„è³‡æ–™</strong>ï¼Œæ½›åœ¨å‘é‡æ˜¯<strong>ç¢ºå®šçš„é»</strong>
                </div>
            </div>
        </div>
        
        <!-- VAE -->
        <div class="architecture-section">
            <h2>
                <span style="font-size: 1.5em;">ğŸŸ¢</span>
                VAEï¼ˆè®Šåˆ†è‡ªç·¨ç¢¼å™¨ï¼‰
            </h2>
            <canvas id="vaeCanvas"></canvas>
            <div class="description">
                <strong>æµç¨‹èªªæ˜ï¼š</strong>
                <ul>
                    <li><strong>è¼¸å…¥ï¼š</strong>åŸå§‹è³‡æ–™ X</li>
                    <li><strong>Encoderï¼š</strong>è¼¸å‡º<strong>æ©Ÿç‡åˆ†ä½ˆçš„åƒæ•¸</strong>ï¼ˆÎ¼ å’Œ ÏƒÂ²ï¼‰</li>
                    <li><strong>æ¡æ¨£ï¼š</strong>å¾åˆ†ä½ˆ N(Î¼, ÏƒÂ²) ä¸­æ¡æ¨£å¾—åˆ°æ½›åœ¨å‘é‡ z</li>
                    <li><strong>Decoderï¼š</strong>å¾æ¡æ¨£çš„ z é‡å»ºè³‡æ–™</li>
                    <li><strong>è¼¸å‡ºï¼š</strong>é‡å»ºçš„è³‡æ–™ X' + <strong>KL æ•£åº¦æå¤±</strong></li>
                </ul>
                <div class="key-point">
                    ğŸ¯ é—œéµç‰¹é»ï¼šæ½›åœ¨å‘é‡ä¾†è‡ª<strong>æ©Ÿç‡åˆ†ä½ˆ</strong>ï¼Œå¯ä»¥ç”Ÿæˆæ–°è³‡æ–™ï¼Œæœ‰é¡å¤–çš„ KL æ•£åº¦æ­£å‰‡åŒ–
                </div>
            </div>
        </div>
        
        <!-- åœ–ä¾‹ -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-box" style="background: #3498db;"></div>
                <span>è¼¸å…¥è³‡æ–™</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #e74c3c;"></div>
                <span>Encoder</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #f39c12;"></div>
                <span>æ½›åœ¨è¡¨ç¤º</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #9b59b6;"></div>
                <span>Decoder</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #2ecc71;"></div>
                <span>è¼¸å‡ºè³‡æ–™</span>
            </div>
        </div>
        
        <!-- æ¯”è¼ƒè¡¨æ ¼ -->
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>ç‰¹æ€§</th>
                    <th>Encoder-Decoder</th>
                    <th>Autoencoder</th>
                    <th>VAE</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>è¼¸å…¥èˆ‡è¼¸å‡ºé—œä¿‚</strong></td>
                    <td>ä¸åŒè³‡æ–™</td>
                    <td>ç›¸åŒè³‡æ–™</td>
                    <td>ç›¸åŒè³‡æ–™</td>
                </tr>
                <tr>
                    <td><strong>æ½›åœ¨è¡¨ç¤ºæ€§è³ª</strong></td>
                    <td>ä¸Šä¸‹æ–‡å‘é‡ï¼ˆè³‡è¨Šå‚³éï¼‰</td>
                    <td>ç¢ºå®šæ€§å‘é‡</td>
                    <td>æ©Ÿç‡åˆ†ä½ˆï¼ˆÎ¼, ÏƒÂ²ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>æå¤±å‡½æ•¸</strong></td>
                    <td>äº¤å‰ç†µæå¤±</td>
                    <td>é‡å»ºæå¤±ï¼ˆMSEï¼‰</td>
                    <td>é‡å»ºæå¤± + KL æ•£åº¦</td>
                </tr>
                <tr>
                    <td><strong>ä¸»è¦ç”¨é€”</strong></td>
                    <td>åºåˆ—è½‰æ›ï¼ˆç¿»è­¯ã€æ‘˜è¦ï¼‰</td>
                    <td>é™ç¶­ã€ç‰¹å¾µæå–ã€å»å™ª</td>
                    <td>ç”Ÿæˆæ–°è³‡æ–™ã€ç‰¹å¾µå­¸ç¿’</td>
                </tr>
                <tr>
                    <td><strong>ç”Ÿæˆèƒ½åŠ›</strong></td>
                    <td>ç”Ÿæˆç›®æ¨™åºåˆ—</td>
                    <td>è¼ƒå¼±ï¼ˆåªèƒ½é‡å»ºï¼‰</td>
                    <td>å¼·ï¼ˆå¯ç”Ÿæˆæ–°æ¨£æœ¬ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>è¨“ç·´æ–¹å¼</strong></td>
                    <td>ç›£ç£å­¸ç¿’ï¼ˆéœ€æˆå°è³‡æ–™ï¼‰</td>
                    <td>ç„¡ç›£ç£å­¸ç¿’</td>
                    <td>ç„¡ç›£ç£å­¸ç¿’</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // ç­‰å¾…é é¢è¼‰å…¥å®Œæˆ
        function init() {
            drawEncoderDecoder();
            drawAutoencoder();
            drawVAE();
        }
        
        // ç¹ªè£½ Encoder-Decoder æ¶æ§‹
        function drawEncoderDecoder() {
            const canvas = document.getElementById('encoderDecoderCanvas');
            const ctx = canvas.getContext('2d');
            
            // è¨­å®šç•«å¸ƒå¤§å°
            canvas.width = canvas.offsetWidth;
            canvas.height = 250;
            
            const w = canvas.width;
            const h = canvas.height;
            const boxWidth = 120;
            const boxHeight = 80;
            const spacing = 80;
            
            // è¨ˆç®—èµ·å§‹ä½ç½®ï¼ˆç½®ä¸­ï¼‰
            const totalWidth = boxWidth * 4 + spacing * 3;
            const startX = (w - totalWidth) / 2;
            const centerY = h / 2;
            
            // ç¹ªè£½æ–¹æ¡†çš„å‡½æ•¸
            function drawBox(x, y, width, height, color, label, sublabel) {
                // é™°å½±
                ctx.shadowColor = 'rgba(0,0,0,0.2)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetX = 3;
                ctx.shadowOffsetY = 3;
                
                // æ–¹æ¡†
                ctx.fillStyle = color;
                ctx.fillRect(x, y, width, height);
                
                // é‡ç½®é™°å½±
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;
                
                // é‚Šæ¡†
                ctx.strokeStyle = '#2c3e50';
                ctx.lineWidth = 3;
                ctx.strokeRect(x, y, width, height);
                
                // æ–‡å­—
                ctx.fillStyle = 'white';
                ctx.font = 'bold 18px Arial, å¾®è»Ÿæ­£é»‘é«”';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(label, x + width / 2, y + height / 2 - 10);
                
                if (sublabel) {
                    ctx.font = '14px Arial, å¾®è»Ÿæ­£é»‘é«”';
                    ctx.fillText(sublabel, x + width / 2, y + height / 2 + 12);
                }
            }
            
            // ç¹ªè£½ç®­é ­çš„å‡½æ•¸
            function drawArrow(fromX, fromY, toX, toY, label) {
                ctx.strokeStyle = '#34495e';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(fromX, fromY);
                ctx.lineTo(toX, toY);
                ctx.stroke();
                
                // ç®­é ­
                const angle = Math.atan2(toY - fromY, toX - fromX);
                const arrowSize = 12;
                ctx.beginPath();
                ctx.moveTo(toX, toY);
                ctx.lineTo(toX - arrowSize * Math.cos(angle - Math.PI / 6), 
                          toY - arrowSize * Math.sin(angle - Math.PI / 6));
                ctx.lineTo(toX - arrowSize * Math.cos(angle + Math.PI / 6), 
                          toY - arrowSize * Math.sin(angle + Math.PI / 6));
                ctx.closePath();
                ctx.fillStyle = '#34495e';
                ctx.fill();
                
                // æ¨™ç±¤
                if (label) {
                    ctx.fillStyle = '#34495e';
                    ctx.font = '14px Arial, å¾®è»Ÿæ­£é»‘é«”';
                    ctx.textAlign = 'center';
                    ctx.fillText(label, (fromX + toX) / 2, fromY - 15);
                }
            }
            
            // ç¹ªè£½å„å€‹çµ„ä»¶
            const x1 = startX;
            const x2 = startX + boxWidth + spacing;
            const x3 = startX + (boxWidth + spacing) * 2;
            const x4 = startX + (boxWidth + spacing) * 3;
            const y = centerY - boxHeight / 2;
            
            drawBox(x1, y, boxWidth, boxHeight, '#3498db', 'æºåºåˆ—', '"Hello"');
            drawBox(x2, y, boxWidth, boxHeight, '#e74c3c', 'Encoder', 'ç·¨ç¢¼');
            drawBox(x3, y, boxWidth, boxHeight, '#f39c12', 'Context', 'ä¸Šä¸‹æ–‡å‘é‡');
            drawBox(x4, y + 40, boxWidth, boxHeight, '#9b59b6', 'Decoder', 'è§£ç¢¼');
            
            // ç¹ªè£½ç®­é ­
            drawArrow(x1 + boxWidth, centerY, x2, centerY, '');
            drawArrow(x2 + boxWidth, centerY, x3, centerY, '');
            drawArrow(x3 + boxWidth, centerY + 40, x4, centerY + 40, '');
            
            // è¼¸å‡º
            drawBox(x4 + boxWidth + spacing - 20, y, boxWidth, boxHeight, '#2ecc71', 'ç›®æ¨™åºåˆ—', '"ä½ å¥½"');
            drawArrow(x4 + boxWidth, centerY + 40, x4 + boxWidth + spacing - 20, centerY, '');
            
            // æ¨™è¨»
            ctx.fillStyle = '#e74c3c';
            ctx.font = 'bold 16px Arial, å¾®è»Ÿæ­£é»‘é«”';
            ctx.textAlign = 'center';
            ctx.fillText('è¼¸å…¥ â‰  è¼¸å‡º', w / 2, h - 20);
        }
        
        // ç¹ªè£½ Autoencoder æ¶æ§‹
        function drawAutoencoder() {
            const canvas = document.getElementById('autoencoderCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.offsetWidth;
            canvas.height = 250;
            
            const w = canvas.width;
            const h = canvas.height;
            const boxWidth = 120;
            const boxHeight = 80;
            const spacing = 70;
            
            const totalWidth = boxWidth * 4 + spacing * 3;
            const startX = (w - totalWidth) / 2;
            const centerY = h / 2;
            
            function drawBox(x, y, width, height, color, label, sublabel) {
                ctx.shadowColor = 'rgba(0,0,0,0.2)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetX = 3;
                ctx.shadowOffsetY = 3;
                
                ctx.fillStyle = color;
                ctx.fillRect(x, y, width, height);
                
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;
                
                ctx.strokeStyle = '#2c3e50';
                ctx.lineWidth = 3;
                ctx.strokeRect(x, y, width, height);
                
                ctx.fillStyle = 'white';
                ctx.font = 'bold 18px Arial, å¾®è»Ÿæ­£é»‘é«”';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(label, x + width / 2, y + height / 2 - 10);
                
                if (sublabel) {
                    ctx.font = '14px Arial, å¾®è»Ÿæ­£é»‘é«”';
                    ctx.fillText(sublabel, x + width / 2, y + height / 2 + 12);
                }
            }
            
            function drawArrow(fromX, fromY, toX, toY, label) {
                ctx.strokeStyle = '#34495e';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(fromX, fromY);
                ctx.lineTo(toX, toY);
                ctx.stroke();
                
                const angle = Math.atan2(toY - fromY, toX - fromX);
                const arrowSize = 12;
                ctx.beginPath();
                ctx.moveTo(toX, toY);
                ctx.lineTo(toX - arrowSize * Math.cos(angle - Math.PI / 6), 
                          toY - arrowSize * Math.sin(angle - Math.PI / 6));
                ctx.lineTo(toX - arrowSize * Math.cos(angle + Math.PI / 6), 
                          toY - arrowSize * Math.sin(angle + Math.PI / 6));
                ctx.closePath();
                ctx.fillStyle = '#34495e';
                ctx.fill();
                
                if (label) {
                    ctx.fillStyle = '#34495e';
                    ctx.font = '14px Arial, å¾®è»Ÿæ­£é»‘é«”';
                    ctx.textAlign = 'center';
                    ctx.fillText(label, (fromX + toX) / 2, fromY - 15);
                }
            }
            
            const x1 = startX;
            const x2 = startX + boxWidth + spacing;
            const x3 = startX + (boxWidth + spacing) * 2;
            const x4 = startX + (boxWidth + spacing) * 3;
            const y = centerY - boxHeight / 2;
            
            drawBox(x1, y, boxWidth, boxHeight, '#3498db', 'X', 'è¼¸å…¥è³‡æ–™');
            drawBox(x2, y, boxWidth, boxHeight, '#e74c3c', 'Encoder', 'ç·¨ç¢¼å™¨');
            drawBox(x3, y, boxWidth, boxHeight, '#f39c12', 'z', 'æ½›åœ¨å‘é‡');
            drawBox(x4, y, boxWidth, boxHeight, '#9b59b6', 'Decoder', 'è§£ç¢¼å™¨');
            
            drawArrow(x1 + boxWidth, centerY, x2, centerY, '');
            drawArrow(x2 + boxWidth, centerY, x3, centerY, '');
            drawArrow(x3 + boxWidth, centerY, x4, centerY, '');
            
            drawBox(x4 + boxWidth + spacing - 20, y, boxWidth, boxHeight, '#2ecc71', "X'", 'é‡å»ºè³‡æ–™');
            drawArrow(x4 + boxWidth, centerY, x4 + boxWidth + spacing - 20, centerY, '');
            
            // æå¤±å‡½æ•¸æ¨™è¨»
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.arc(x1 + boxWidth / 2, centerY, 50, -Math.PI / 4, -3 * Math.PI / 4, true);
            ctx.stroke();
            ctx.arc(x4 + boxWidth + spacing - 20 + boxWidth / 2, centerY, 50, Math.PI / 4, 3 * Math.PI / 4);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#e74c3c';
            ctx.font = 'bold 16px Arial, å¾®è»Ÿæ­£é»‘é«”';
            ctx.textAlign = 'center';
            ctx.fillText('é‡å»ºæå¤±ï¼š||X - X\'||Â²', w / 2, h - 20);
        }
        
        // ç¹ªè£½ VAE æ¶æ§‹
        function drawVAE() {
            const canvas = document.getElementById('vaeCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = canvas.offsetWidth;
            canvas.height = 250;
            
            const w = canvas.width;
            const h = canvas.height;
            const boxWidth = 100;
            const boxHeight = 70;
            const spacing = 60;
            
            const totalWidth = boxWidth * 5 + spacing * 4;
            const startX = (w - totalWidth) / 2;
            const centerY = h / 2;
            
            function drawBox(x, y, width, height, color, label, sublabel) {
                ctx.shadowColor = 'rgba(0,0,0,0.2)';
                ctx.shadowBlur = 10;
                ctx.shadowOffsetX = 3;
                ctx.shadowOffsetY = 3;
                
                ctx.fillStyle = color;
                ctx.fillRect(x, y, width, height);
                
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;
                
                ctx.strokeStyle = '#2c3e50';
                ctx.lineWidth = 3;
                ctx.strokeRect(x, y, width, height);
                
                ctx.fillStyle = 'white';
                ctx.font = 'bold 16px Arial, å¾®è»Ÿæ­£é»‘é«”';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(label, x + width / 2, y + height / 2 - 8);
                
                if (sublabel) {
                    ctx.font = '12px Arial, å¾®è»Ÿæ­£é»‘é«”';
                    ctx.fillText(sublabel, x + width / 2, y + height / 2 + 10);
                }
            }
            
            function drawArrow(fromX, fromY, toX, toY, label) {
                ctx.strokeStyle = '#34495e';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(fromX, fromY);
                ctx.lineTo(toX, toY);
                ctx.stroke();
                
                const angle = Math.atan2(toY - fromY, toX - fromX);
                const arrowSize = 12;
                ctx.beginPath();
                ctx.moveTo(toX, toY);
                ctx.lineTo(toX - arrowSize * Math.cos(angle - Math.PI / 6), 
                          toY - arrowSize * Math.sin(angle - Math.PI / 6));
                ctx.lineTo(toX - arrowSize * Math.cos(angle + Math.PI / 6), 
                          toY - arrowSize * Math.sin(angle + Math.PI / 6));
                ctx.closePath();
                ctx.fillStyle = '#34495e';
                ctx.fill();
                
                if (label) {
                    ctx.fillStyle = '#34495e';
                    ctx.font = '12px Arial, å¾®è»Ÿæ­£é»‘é«”';
                    ctx.textAlign = 'center';
                    ctx.fillText(label, (fromX + toX) / 2, fromY - 12);
                }
            }
            
            const x1 = startX;
            const x2 = startX + boxWidth + spacing;
            const x3 = startX + (boxWidth + spacing) * 2;
            const x4 = startX + (boxWidth + spacing) * 3;
            const x5 = startX + (boxWidth + spacing) * 4;
            const y = centerY - boxHeight / 2;
            
            drawBox(x1, y, boxWidth, boxHeight, '#3498db', 'X', 'è¼¸å…¥');
            drawBox(x2, y, boxWidth, boxHeight, '#e74c3c', 'Encoder', '');
            drawBox(x3, y, boxWidth, boxHeight, '#f39c12', 'Î¼, ÏƒÂ²', 'åˆ†ä½ˆåƒæ•¸');
            drawBox(x4, y, boxWidth, boxHeight, '#f39c12', 'z ~ N', 'æ¡æ¨£');
            drawBox(x5, y, boxWidth, boxHeight, '#9b59b6', 'Decoder', '');
            
            drawArrow(x1 + boxWidth, centerY, x2, centerY, '');
            drawArrow(x2 + boxWidth, centerY, x3, centerY, '');
            drawArrow(x3 + boxWidth, centerY, x4, centerY, 'é‡åƒæ•¸åŒ–');
            drawArrow(x4 + boxWidth, centerY, x5, centerY, '');
            
            drawBox(x5 + boxWidth + spacing - 10, y, boxWidth, boxHeight, '#2ecc71', "X'", 'é‡å»º');
            drawArrow(x5 + boxWidth, centerY, x5 + boxWidth + spacing - 10, centerY, '');
            
            // KL æ•£åº¦æ¨™è¨»
            ctx.fillStyle = '#9b59b6';
            ctx.font = 'bold 14px Arial, å¾®è»Ÿæ­£é»‘é«”';
            ctx.textAlign = 'center';
            ctx.fillText('KL(q(z|x) || p(z))', x3 + boxWidth / 2, y - 25);
            
            ctx.strokeStyle = '#9b59b6';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(x3 + boxWidth / 2 - 30, y - 15);
            ctx.lineTo(x3 + boxWidth / 2 - 30, y);
            ctx.stroke();
            ctx.setLineDash([]);
            
            ctx.fillStyle = '#e74c3c';
            ctx.font = 'bold 16px Arial, å¾®è»Ÿæ­£é»‘é«”';
            ctx.fillText('æå¤± = é‡å»ºæå¤± + Î² Ã— KL æ•£åº¦', w / 2, h - 20);
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
